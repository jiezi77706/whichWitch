# ğŸ”— é’±åŒ…è¿æ¥åŠŸèƒ½è¯´æ˜

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é’±åŒ…è¿æ¥åŸºç¡€è®¾æ–½
ä½ çš„é¡¹ç›®å·²ç»é…ç½®å¥½äº†å®Œæ•´çš„ Web3 é’±åŒ…è¿æ¥åŸºç¡€ï¼š

- âœ… **Wagmi** - Web3 React Hooks åº“
- âœ… **Viem** - ä»¥å¤ªåŠäº¤äº’åº“
- âœ… **Web3Provider** - å…¨å±€ Provider é…ç½®
- âœ… **ç½‘ç»œé…ç½®** - Sepolia æµ‹è¯•ç½‘
- âœ… **RPC é…ç½®** - Alchemy RPC URL

### 2. æ–°å¢çš„çœŸå®é’±åŒ…è¿æ¥åŠŸèƒ½

#### åˆ›å»ºçš„æ–‡ä»¶ï¼š
- `src/ui/components/wallet-connect-button.tsx` - ç‹¬ç«‹çš„é’±åŒ…è¿æ¥æŒ‰é’®ç»„ä»¶

#### æ›´æ–°çš„æ–‡ä»¶ï¼š
- `src/ui/components/whichwitch/auth-view.tsx` - é›†æˆçœŸå®çš„é’±åŒ…è¿æ¥

### 3. åŠŸèƒ½ç‰¹æ€§

#### âœ… çœŸå®çš„ MetaMask è¿æ¥
```typescript
import { useAccount, useConnect, useDisconnect } from 'wagmi';

// è¿æ¥é’±åŒ…
const { connect, connectors } = useConnect();
connect({ connector: connectors[0] }); // MetaMask

// è·å–è¿æ¥çŠ¶æ€
const { address, isConnected } = useAccount();

// æ–­å¼€è¿æ¥
const { disconnect } = useDisconnect();
```

#### âœ… è‡ªåŠ¨æ£€æµ‹é’±åŒ…è¿æ¥
å½“ç”¨æˆ·è¿æ¥é’±åŒ…åï¼Œä¼šè‡ªåŠ¨ï¼š
1. è·å–é’±åŒ…åœ°å€
2. æ˜¾ç¤ºåœ°å€ï¼ˆæ ¼å¼åŒ–ä¸º 0x1234...5678ï¼‰
3. è¿›å…¥ä¸ªäººèµ„æ–™è®¾ç½®é¡µé¢
4. ä½¿ç”¨çœŸå®çš„é’±åŒ…åœ°å€ä½œä¸º DID

#### âœ… è¿æ¥çŠ¶æ€æ˜¾ç¤º
- æœªè¿æ¥ï¼šæ˜¾ç¤º "Connect Wallet" æŒ‰é’®
- è¿æ¥ä¸­ï¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- å·²è¿æ¥ï¼šæ˜¾ç¤ºé’±åŒ…åœ°å€å’Œ "Disconnect" æŒ‰é’®

---

## ğŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1: åœ¨ Auth View ä¸­ï¼ˆå·²é›†æˆï¼‰
ç”¨æˆ·ç‚¹å‡» "Connect Wallet" æŒ‰é’®ä¼šï¼š
1. å¼¹å‡º MetaMask è¿æ¥è¯·æ±‚
2. ç”¨æˆ·æ‰¹å‡†åè‡ªåŠ¨è¿æ¥
3. æ˜¾ç¤ºé’±åŒ…åœ°å€
4. è¿›å…¥ä¸ªäººèµ„æ–™è®¾ç½®

### æ–¹å¼ 2: ä½¿ç”¨ç‹¬ç«‹ç»„ä»¶
åœ¨ä»»ä½•é¡µé¢ä¸­ä½¿ç”¨é’±åŒ…è¿æ¥æŒ‰é’®ï¼š

```tsx
import { WalletConnectButton } from '@/components/wallet-connect-button';

export default function MyPage() {
  return (
    <div>
      <WalletConnectButton />
    </div>
  );
}
```

### æ–¹å¼ 3: åœ¨æµ‹è¯•é¡µé¢ä¸­
è®¿é—® `http://localhost:3000/test-connection` æŸ¥çœ‹ï¼š
- é’±åŒ…è¿æ¥çŠ¶æ€
- åˆçº¦è¿æ¥çŠ¶æ€
- æ•°æ®åº“è¿æ¥çŠ¶æ€
- æ‰€æœ‰ç¯å¢ƒå˜é‡

---

## ğŸ¯ é’±åŒ…è¿æ¥æµç¨‹

```
ç”¨æˆ·ç‚¹å‡» "Connect Wallet"
         â†“
    å¼¹å‡º MetaMask
         â†“
    ç”¨æˆ·æ‰¹å‡†è¿æ¥
         â†“
    è·å–é’±åŒ…åœ°å€
         â†“
  æ˜¾ç¤ºåœ°å€ (0x1234...5678)
         â†“
   è‡ªåŠ¨è¿›å…¥ä¸ªäººèµ„æ–™è®¾ç½®
         â†“
  å¡«å†™åç§°ã€ç®€ä»‹ã€æŠ€èƒ½
         â†“
   ç‚¹å‡» "Mint DID Identity"
         â†“
  åˆ›å»ºé“¾ä¸Šèº«ä»½ï¼ˆä½¿ç”¨çœŸå®åœ°å€ï¼‰
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### Web3Provider é…ç½®
ä½ç½®: `src/ui/components/providers/web3-provider.tsx`

```tsx
import { WagmiProvider } from 'wagmi';
import { config } from '@/lib/web3/config';

export function Web3Provider({ children }) {
  return (
    <WagmiProvider config={config}>
      <QueryClientProvider client={queryClient}>
        {children}
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```

### Wagmi é…ç½®
ä½ç½®: `src/ui/lib/web3/config.ts`

```tsx
import { createConfig, http } from 'wagmi';
import { sepolia } from 'wagmi/chains';
import { injected } from 'wagmi/connectors';

export const config = createConfig({
  chains: [sepolia],
  connectors: [injected()], // MetaMask
  transports: {
    [sepolia.id]: http(process.env.NEXT_PUBLIC_RPC_URL),
  },
});
```

---

## ğŸ§ª æµ‹è¯•é’±åŒ…è¿æ¥

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

### 2. è®¿é—®åº”ç”¨
```
http://localhost:3000
```

### 3. æµ‹è¯•æ­¥éª¤
1. ç¡®ä¿å®‰è£…äº† MetaMask æµè§ˆå™¨æ’ä»¶
2. åˆ‡æ¢ MetaMask åˆ° Sepolia æµ‹è¯•ç½‘
3. ç‚¹å‡» "Connect Wallet" æŒ‰é’®
4. åœ¨ MetaMask å¼¹çª—ä¸­ç‚¹å‡» "è¿æ¥"
5. æŸ¥çœ‹æ˜¯å¦æ˜¾ç¤ºä½ çš„é’±åŒ…åœ°å€
6. å¡«å†™ä¸ªäººèµ„æ–™
7. ç‚¹å‡» "Mint DID Identity"

### 4. æµ‹è¯•è¿æ¥é¡µé¢
è®¿é—® `http://localhost:3000/test-connection` æŸ¥çœ‹ï¼š
- âœ… Web3 é’±åŒ…è¿æ¥çŠ¶æ€
- âœ… æ™ºèƒ½åˆçº¦è¿æ¥çŠ¶æ€
- âœ… Supabase æ•°æ®åº“è¿æ¥çŠ¶æ€
- âœ… Pinata IPFS é…ç½®çŠ¶æ€

---

## ğŸ“± æ”¯æŒçš„é’±åŒ…

å½“å‰é…ç½®æ”¯æŒï¼š
- âœ… **MetaMask** - æœ€æµè¡Œçš„ä»¥å¤ªåŠé’±åŒ…
- âœ… **Coinbase Wallet** - é€šè¿‡ injected connector
- âœ… **å…¶ä»–å…¼å®¹é’±åŒ…** - ä»»ä½•æ”¯æŒ EIP-1193 çš„é’±åŒ…

### æ·»åŠ æ›´å¤šé’±åŒ…è¿æ¥å™¨
å¦‚æœéœ€è¦æ”¯æŒ WalletConnect ç­‰å…¶ä»–è¿æ¥æ–¹å¼ï¼š

```bash
npm install @wagmi/connectors
```

```tsx
import { walletConnect } from 'wagmi/connectors';

export const config = createConfig({
  chains: [sepolia],
  connectors: [
    injected(),
    walletConnect({ projectId: 'YOUR_PROJECT_ID' }),
  ],
  // ...
});
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç½‘ç»œåˆ‡æ¢
ç¡®ä¿ MetaMask è¿æ¥åˆ° **Sepolia æµ‹è¯•ç½‘**ï¼š
- ç½‘ç»œåç§°: Sepolia
- Chain ID: 11155111
- RPC URL: å·²åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®

### 2. æµ‹è¯•å¸
éœ€è¦ Sepolia æµ‹è¯• ETH æ‰èƒ½è¿›è¡Œé“¾ä¸Šäº¤æ˜“ï¼š
- https://sepoliafaucet.com/
- https://www.alchemy.com/faucets/ethereum-sepolia

### 3. ç¯å¢ƒå˜é‡
ç¡®ä¿ `.env.local` ä¸­é…ç½®äº†ï¼š
```env
NEXT_PUBLIC_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_KEY
NEXT_PUBLIC_CHAIN_ID=11155111
NEXT_PUBLIC_NETWORK_NAME=sepolia
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### å·²å®Œæˆ âœ…
- [x] é…ç½® Wagmi å’Œ Web3Provider
- [x] åˆ›å»ºé’±åŒ…è¿æ¥ç»„ä»¶
- [x] é›†æˆåˆ° Auth View
- [x] ä½¿ç”¨çœŸå®é’±åŒ…åœ°å€ä½œä¸º DID
- [x] æ˜¾ç¤ºè¿æ¥çŠ¶æ€

### å¯ä»¥æ‰©å±• ğŸ”„
- [ ] æ·»åŠ ç½‘ç»œåˆ‡æ¢åŠŸèƒ½
- [ ] æ·»åŠ å¤šé’±åŒ…æ”¯æŒï¼ˆWalletConnectï¼‰
- [ ] ä¿å­˜ç”¨æˆ·èµ„æ–™åˆ° Supabase
- [ ] å®ç°çœŸå®çš„é“¾ä¸Š DID é“¸é€ 
- [ ] æ·»åŠ äº¤æ˜“ç­¾ååŠŸèƒ½
- [ ] é›†æˆæ™ºèƒ½åˆçº¦è°ƒç”¨

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Wagmi æ–‡æ¡£](https://wagmi.sh/)
- [Viem æ–‡æ¡£](https://viem.sh/)
- [MetaMask æ–‡æ¡£](https://docs.metamask.io/)
- [Sepolia æµ‹è¯•ç½‘](https://sepolia.dev/)

---

**ğŸ‰ ä½ çš„é¡¹ç›®ç°åœ¨å·²ç»æœ‰å®Œæ•´çš„é’±åŒ…è¿æ¥åŠŸèƒ½äº†ï¼**
